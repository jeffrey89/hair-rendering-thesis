\relax 
\@writefile{toc}{\contentsline {chapter}{\numberline {1}Introduction}{2}}
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\citation{marschner}
\citation{zinke}
\citation{eon2013}
\citation{zinke}
\citation{eon2013}
\citation{eon2011}
\citation{eon2013}
\citation{eon2013}
\citation{zinke}
\@writefile{toc}{\contentsline {section}{\numberline {1.1}Goal and approach}{3}}
\citation{eon2013}
\citation{ward}
\citation{hadap}
\citation{hadap}
\citation{marschner}
\citation{ward}
\citation{ward}
\citation{marschner}
\citation{morganti2015}
\citation{marschner}
\citation{morganti2015}
\@writefile{toc}{\contentsline {chapter}{\numberline {2}Background}{5}}
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\citation{marschner}
\citation{ward}
\@writefile{lof}{\contentsline {figure}{\numberline {2.1}{\ignorespaces On the left the tilted cuticle scales on the outside of the hair fiber (taken from Marschner et al.\nobreakspace  {}\cite  {marschner}). On the right a cross section overview of the core of a hair fiber, consisting of the cuticle scales with the cortex and medulla (taken from Morganti\nobreakspace  {}\cite  {morganti2015}).}}{6}}
\newlabel{fig_hair_structure}{{2.1}{6}}
\@writefile{toc}{\contentsline {section}{\numberline {2.1}Rendering hair}{6}}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.1.1}Explicit Representation}{6}}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.1.2}Implicit Representation}{6}}
\citation{pharr2017}
\citation{pharr2017}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.1.3}Geometric complexity}{7}}
\citation{hadap}
\citation{marschner}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.1.4}Aliasing problem}{8}}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.1.5}Mathematical Notation}{8}}
\newlabel{sec_mathematical_notation}{{2.1.5}{8}}
\citation{marschner}
\citation{marschner}
\@writefile{lof}{\contentsline {figure}{\numberline {2.2}{\ignorespaces An overview of the coordinate axes and the spherical angles with respect to a hair fiber. This is the convention used in this thesis and is used by Marschner et al. and most other hair rendering algorithms. Picture taken from Marschner et al.\nobreakspace  {}\cite  {marschner}.}}{9}}
\newlabel{axis_overview}{{2.2}{9}}
\@writefile{toc}{\contentsline {section}{\numberline {2.2}Radiometry}{9}}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.2.1}Power and radiant flux}{9}}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.2.2}Solid Angle and Radiant Intensity}{10}}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.2.3}Irradiance}{10}}
\newlabel{radiance_irradiance}{{2.2.3}{10}}
\@writefile{lof}{\contentsline {figure}{\numberline {2.3}{\ignorespaces Graphical representation of angles and solid angles. $\theta $ represents a two-dimensional angle. If the circle is considered a unit sphere, then the length of line $l$ equals $\theta $ radians and it subtends the red lines on the right. The solid angle $\Omega $ is a three-dimensional angle represented by a cone. At the unit sphere, the solid angle represents a surface area $A$. The red disks shown on the outside represents three-dimensional objects that are subtended by the solid angle $\Omega $. Larger objects can be subtended by the same solid angle as they are placed farther away from the center of the sphere. As the solid angle becomes infinitely small, we obtain a direction vector $\omega $.}}{11}}
\newlabel{fig_solidangle}{{2.3}{11}}
\citation{pharr2017}
\@writefile{lof}{\contentsline {figure}{\numberline {2.4}{\ignorespaces As the incoming light hits the surface at a larger angle, the irradiance decreases because the same amount of light will be spread over a greater surface area.}}{12}}
\newlabel{cosine_term_visualization}{{2.4}{12}}
\newlabel{eq_irradiance1}{{2.1}{12}}
\newlabel{eq_irradiance1}{{2.2}{12}}
\citation{pharr2017}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.2.4}Radiance}{13}}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.2.5}Bidirectional Reflection Distribution Function (BRDF)}{13}}
\@writefile{toc}{\contentsline {section}{\numberline {2.3}sec_bsdf}{13}}
\newlabel{eq_brdf}{{2.4}{13}}
\citation{ward}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.3.1}Bidirectional Curve Scattering Distribution Function (BCDSF)}{14}}
\newlabel{sec_bcsdf}{{2.3.1}{14}}
\newlabel{eq_bcsdf}{{2.7}{14}}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.3.2}Rendering Equation}{14}}
\citation{pharr2017}
\newlabel{rendering_eq}{{2.8}{15}}
\newlabel{renderingEquation}{{2.9}{15}}
\@writefile{toc}{\contentsline {section}{\numberline {2.4}Importance Sampling}{15}}
\newlabel{basics_importance_sampling}{{2.4}{15}}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.4.1}Monte-Carlo integration}{15}}
\citation{pharr2017}
\citation{pharr2017}
\citation{pharr2017}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.4.2}Importance sampling}{16}}
\newlabel{section_importance_sampling}{{2.4.2}{16}}
\@writefile{toc}{\contentsline {subsection}{\numberline {2.4.3}Multiple importance sampling}{16}}
\citation{ward}
\citation{kajiya}
\citation{kajiya}
\citation{kajiya}
\@writefile{toc}{\contentsline {chapter}{\numberline {3}Related Work}{18}}
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\@writefile{toc}{\contentsline {section}{\numberline {3.1}Hair Rendering Overview}{18}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.1.1}Single fiber scattering}{18}}
\citation{goldman}
\citation{marschner}
\citation{hadap}
\citation{marschner}
\citation{marschner}
\citation{ward}
\@writefile{lof}{\contentsline {figure}{\numberline {3.1}{\ignorespaces Comparison of Kajiya and Kay model with the Marschner model. The left image represents Kajiya and Kay's model. The center image is the Marschner model and the right image represents the original real-world photographed reference. Picture taken from Marschner et al.\nobreakspace  {}\cite  {marschner}.}}{19}}
\newlabel{fig_compare_kajiya}{{3.1}{19}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.1.2}Multiple fiber scattering}{19}}
\citation{ward}
\citation{jensen}
\citation{jensen}
\citation{moon}
\citation{moon}
\citation{zinke}
\citation{kajiya}
\citation{marschner}
\citation{zinke}
\@writefile{toc}{\contentsline {section}{\numberline {3.2}Marschner model}{20}}
\newlabel{sec_marschner}{{3.2}{20}}
\citation{marschner}
\citation{stamm1977}
\citation{bustard1991}
\citation{marschner}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.2.1}Observations}{21}}
\@writefile{toc}{\contentsline {subsubsection}{Longitudinal variation (Primary and secondary highlight)}{21}}
\newlabel{sec_longitudinal_observation}{{3.2.1}{21}}
\citation{marschner}
\citation{marschner}
\citation{marschner}
\citation{marschner}
\@writefile{lof}{\contentsline {figure}{\numberline {3.2}{\ignorespaces The scattering behaviour in the incidence plane (longitudinal scattering). For human hair the specular reflection is shifted towards the root by a few degrees. For synthetic hair no shifted highlight is visible, because synthetic hair doesn't consist of tilted cuticle scales.}}{22}}
\newlabel{fig_longitudinal_marschner}{{3.2}{22}}
\@writefile{toc}{\contentsline {subsubsection}{Azimuthal variation}{22}}
\citation{marschner}
\citation{eon2011}
\citation{gray}
\citation{gray}
\citation{marcuse1974}
\citation{adler1998}
\citation{mount1998}
\@writefile{lof}{\contentsline {figure}{\numberline {3.3}{\ignorespaces Measurements of azimuthal scattering (scattering in the normal plane). The light source is shining from the right, while the hair fiber is rotated. The green ellipse is the cross section of the fiber for different measurements with increasing rotations of the fiber. Figure taken from Marschner et al.\nobreakspace  {}\cite  {marschner}.}}{23}}
\newlabel{fig_azimuthal_marschner}{{3.3}{23}}
\@writefile{lof}{\contentsline {figure}{\numberline {3.4}{\ignorespaces An image from Gray et al.\nobreakspace  {}\cite  {gray} showing a female with brown hair. The three scattering modes: R, TT and TRT contributions are visible in the hair. Glints give hair it's characteristic texture.}}{24}}
\newlabel{female_hair}{{3.4}{24}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.2.2}Model}{24}}
\citation{marschner}
\citation{eon2011}
\citation{marschner}
\citation{marschner}
\citation{marschner}
\citation{marschner}
\newlabel{marschner_model_scatterfunction}{{3.1}{25}}
\@writefile{toc}{\contentsline {subsubsection}{Longitudinal Scattering Function}{25}}
\newlabel{marschner_longitudinal_scattering_function}{{3.2.2}{25}}
\@writefile{toc}{\contentsline {subsubsection}{Azimuthal Scattering Function}{25}}
\@writefile{lot}{\contentsline {table}{\numberline {3.1}{\ignorespaces Typical values for parameters for the longitudinal scattering function. $alpha$ is the longitudinal shift to represent the shift of the lobe due to tilted cuticle scales. $\beta $ is the longitudinal width, representing the spread of the energy due to rough surface of hair fibers. Taken from Marschner et al.\nobreakspace  {}\cite  {marschner}}}{26}}
\newlabel{table_marschner_alpha_beta}{{3.1}{26}}
\newlabel{eq_relative_azimuth_change}{{3.5}{26}}
\@writefile{toc}{\contentsline {subsubsection}{Finding roots}{26}}
\citation{marschner}
\citation{eon2011}
\citation{marschner}
\@writefile{lof}{\contentsline {figure}{\numberline {3.5}{\ignorespaces Cross section of a hair fiber showing the different scattering modes. Taken from Marschner et al.\nobreakspace  {}\cite  {marschner}}}{27}}
\newlabel{fig_circular_cross_section}{{3.5}{27}}
\@writefile{toc}{\contentsline {subsubsection}{Attenuation}{27}}
\citation{marschner}
\citation{marschner}
\@writefile{lof}{\contentsline {figure}{\numberline {3.6}{\ignorespaces Visualization of the root finding stratgegy. The relative difference angle $\phi _p$ between rays $\omega _o$ and $\omega _{i,p}$ is known by computing the difference of the azimuthal spherical coordinates. The Marschner model can be evaluated when the roots are known. The roots $h$ can be found by solving the roots of equation $2p\gamma _t - 2\gamma _i + p\pi - \phi _p = 0$. Knowing $\gamma _i$ will trivially give $h$.}}{28}}
\newlabel{fig_rootfinding}{{3.6}{28}}
\newlabel{azimuthal_marschner}{{3.7}{28}}
\citation{marschner}
\citation{marschner}
\citation{eon2011}
\citation{zinke}
\@writefile{toc}{\contentsline {subsubsection}{Glints}{29}}
\@writefile{toc}{\contentsline {subsubsection}{Taking into account eccentricity}{29}}
\@writefile{toc}{\contentsline {subsubsection}{The Marschner scattering model}{29}}
\newlabel{eq_marschner}{{3.13}{29}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.2.3}Evaluation}{29}}
\citation{zinke}
\citation{zinke}
\citation{zinke}
\citation{zinke}
\@writefile{toc}{\contentsline {section}{\numberline {3.3}Dualscattering Approximation}{30}}
\newlabel{sec_dualscattering}{{3.3}{30}}
\citation{zinke}
\citation{zinke}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.3.1}Global Multiple Scattering Function $\Psi ^G$}{31}}
\@writefile{toc}{\contentsline {subsubsection}{Forward Scattering Transmittance}{31}}
\citation{zinke}
\citation{zinke}
\citation{sadeghi}
\newlabel{dualscattering_Tf}{{3.17}{32}}
\@writefile{lof}{\contentsline {figure}{\numberline {3.7}{\ignorespaces This picture shows the cross section of a hair cluster. The factor $d_f$ is a tweaking variable to account for the portion of multiple scattered radiance reaching the point $x$. The orange region shows the forward scattering contribution. It can be seen that the light could have direct vision with point $x$ in which case there is no multiple scattered radiance. $d_f$ accounts for this fact. If $d_f$ is 1, then it is assumed that point $x$ is fully covered by hair strands as seen from the light direction. The same applies for the backward scattering attenuation factor $d_b$ (blue region). Usually both $d_f$ and $d_b$ are constant for the full model and set to 0.7.}}{32}}
\newlabel{fig_df}{{3.7}{32}}
\citation{zinke}
\citation{zinke}
\newlabel{forwardscattering}{{3.18}{33}}
\@writefile{toc}{\contentsline {subsubsection}{Forward Scattering Spread}{33}}
\newlabel{dualscattering_Sf}{{3.19}{33}}
\@writefile{toc}{\contentsline {subsection}{\numberline {3.3.2}Local Multiple Scattering}{33}}
\@writefile{toc}{\contentsline {subsubsection}{Average Backscattering Attenuation}{34}}
\citation{zinke}
\citation{zinke}
\citation{sadeghi}
\@writefile{toc}{\contentsline {subsubsection}{Average Backscattering Spread}{35}}
\citation{zinke}
\@writefile{toc}{\contentsline {chapter}{\numberline {4}Approach}{36}}
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\citation{eon2013}
\citation{eon2013}
\@writefile{toc}{\contentsline {section}{\numberline {4.1}Problem 1: How to apply multiple importance scattering to the dual scattering method?}{37}}
\newlabel{approach_problem1}{{4.1}{37}}
\citation{eon2013}
\citation{zinke}
\@writefile{toc}{\contentsline {section}{\numberline {4.2}Problem 2: How to evaluate rendered images using multiple importance sampling?}{38}}
\citation{eon2013}
\citation{eon2011}
\citation{eon2011}
\@writefile{toc}{\contentsline {section}{\numberline {4.3}Theoretical details about importance sampling for dual scattering method}{39}}
\citation{eon2013}
\citation{eon2013}
\@writefile{toc}{\contentsline {subsection}{\numberline {4.3.1}Strategy outline}{40}}
\@writefile{toc}{\contentsline {subsection}{\numberline {4.3.2}Lobe selection}{40}}
\newlabel{sec_lobe_selection}{{4.3.2}{40}}
\citation{eon2013}
\@writefile{toc}{\contentsline {subsubsection}{Finding the PDF when directions $\omega _o$ and $\omega _i$ are known}{41}}
\citation{eon2011}
\citation{eon2011}
\@writefile{toc}{\contentsline {subsection}{\numberline {4.3.3}Importance sampling the longitudinal M function}{42}}
\newlabel{sec_importance_sampling_M}{{4.3.3}{42}}
\@writefile{toc}{\contentsline {subsection}{\numberline {4.3.4}Importance sampling the azimuthal N function}{43}}
\newlabel{phi_func}{{4.13}{43}}
\citation{pbrt}
\@writefile{toc}{\contentsline {chapter}{\numberline {5}Implementation}{45}}
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\@writefile{toc}{\contentsline {section}{\numberline {5.1}Problem 1: Which framework to use to render physics based?}{45}}
\citation{zinke}
\@writefile{toc}{\contentsline {section}{\numberline {5.2}Problem 2: How to write code for voxel grid?}{46}}
\citation{zinke}
\@writefile{toc}{\contentsline {section}{\numberline {5.3}Problem 3: How to deal with memory and speed requirements}{48}}
\@writefile{toc}{\contentsline {section}{\numberline {5.4}Importance sampling}{48}}
\@writefile{toc}{\contentsline {section}{\numberline {5.5}The voxel grid}{48}}
\@writefile{toc}{\contentsline {chapter}{\numberline {6}Results}{51}}
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\@writefile{toc}{\contentsline {section}{\numberline {6.1}Dual scattering in real-world situations}{51}}
\@writefile{toc}{\contentsline {subsubsection}{Observations}{52}}
\@writefile{toc}{\contentsline {section}{\numberline {6.2}Variation of the forward and backward density factors}{52}}
\@writefile{toc}{\contentsline {section}{\numberline {6.3}Theoretical Results}{52}}
\@writefile{lot}{\contentsline {table}{\numberline {6.1}{\ignorespaces The relative variance for increasing samples per pixel. For example, when comparing uniform sampling for 16 samples per pixel, the distance compared with 8 samples per pixel is 0.000192 (expressed in variance). If the relative variance is 0, then this indicates the doubling of samples per pixel did not cause a change with the previous image (and thus the result is converged). For 1 sample per pixel there are no results, since there is no previous image to compare with.}}{53}}
\newlabel{table_relative_variance}{{6.1}{53}}
\@writefile{toc}{\contentsline {subsection}{\numberline {6.3.1}Relative variance for increasing samples per pixel}{53}}
\citation{eon2011}
\@writefile{lot}{\contentsline {table}{\numberline {6.2}{\ignorespaces These measurements quantify the error compared with the ground truth. The ground truth is taken as the uniform sampling variant at 512 samples per pixel. Therefore the error for uniform sampling is 0 at 512 samples per pixel, because they are identical. It gives an insight in the convergence rate, together with the graph shown in figure\nobreakspace  {}\G@refundefinedtrue \text  {\normalfont  \bfseries  ??}\GenericWarning  {               }{LaTeX Warning: Reference `fig_variance_plot' on page 54 undefined}.}}{54}}
\newlabel{table_variance_to_groundtruth}{{6.2}{54}}
\@writefile{toc}{\contentsline {subsection}{\numberline {6.3.2}Variance compared to ground truth}{54}}
\newlabel{variance_comparison_gr_truth}{{6.3.2}{54}}
\@writefile{lof}{\contentsline {figure}{\numberline {6.1}{\ignorespaces Comparison between importance sampling and uniform sampling in an office square setting. The images are rendered using 32 samples per pixel.}}{56}}
\newlabel{fig_officesquare}{{6.1}{56}}
\@writefile{lof}{\contentsline {figure}{\numberline {6.2}{\ignorespaces Comparison between importance sampling and uniform sampling in an office square setting. The samples are rendered using 32 samples per pixel.}}{57}}
\newlabel{fig_venice}{{6.2}{57}}
\@writefile{lof}{\contentsline {figure}{\numberline {6.3}{\ignorespaces Comparison between importance sampling and uniform sampling in an office square setting. The samples are rendered using 32 samples per pixel.}}{58}}
\newlabel{fig_subway}{{6.3}{58}}
\@writefile{lof}{\contentsline {figure}{\numberline {6.4}{\ignorespaces A variation of the density factors $d_f$ and $d_b$, corresponding to the amount of global multiple scattering in the hair model. A value of 0 indicates the absence of global multiple scattering and 1 the full presence of global multiple scattering. Usually the value is set to a constant value 0.7.}}{59}}
\newlabel{fig_results_df}{{6.4}{59}}
\@writefile{lof}{\contentsline {figure}{\numberline {6.5}{\ignorespaces This figure displays an outline representing the region of interest for subsequent comparison of rendered results. The variance is computed for the area contained by the outline. This is done so that the background, and nonrelated items have no influence on the variance computation.}}{60}}
\newlabel{fig_variance_outline}{{6.5}{60}}
\@writefile{lof}{\contentsline {figure}{\numberline {6.6}{\ignorespaces Comparison of the image quality between uniform sampling and importance sampling for various pixels per sample, indicated in the bottom left corner. As the pixels per sample increase the noise of the image becomes smaller.}}{61}}
\newlabel{fig_side_by_side}{{6.6}{61}}
\@writefile{lof}{\contentsline {figure}{\numberline {6.7}{\ignorespaces A side by side comparison of converged images for uniform and importance sampling, both rendered at 512 samples per pixel. Both renderings should converge to the same result. Although the result looks similar, the uniform sampling seems slightly brighter.}}{62}}
\newlabel{fig_sidebyside_converged}{{6.7}{62}}
\@writefile{lof}{\contentsline {figure}{\numberline {6.8}{\ignorespaces Performance analysis between uniform sampling and importance sampling in terms of variance. The ground truth is taken to be uniform samples at 512 samples per pixel. The data corresponds to data in table\nobreakspace  {}\G@refundefinedtrue \text  {\normalfont  \bfseries  ??}\GenericWarning  {               }{LaTeX Warning: Reference `table_variance_to_groundtruth' on page 62 undefined}.}}{62}}
\newlabel{fig_variance_plot}{{6.8}{62}}
\citation{eon2011}
\citation{deon2011}
\citation{sadeghi2010}
\citation{zinke}
\@writefile{toc}{\contentsline {chapter}{\numberline {7}Conclusion}{63}}
\@writefile{lof}{\addvspace {10\p@ }}
\@writefile{lot}{\addvspace {10\p@ }}
\citation{eon2011}
\bibdata{thesis}
\bibstyle{plain}
